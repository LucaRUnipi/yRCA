# Sock Echo Experiment
The *Sock Echo* experiment deploys, loads, and analyses the logs generated by a testbed application (obtained with [Chaos Echo](https://github.com/di-unipi-socc/chaos-echo)). 

## Sock Echo
The deployed application mirrors the topology of [Sock Shop](https://microservices-demo.github.io/), from which the name "Sock Echo".
It essentially consists of 14 interacting [Chaos Echo](https://github.com/di-unipi-socc/chaos-echo) services, configured to emulate the interactions between the services forming Sock Shop.

The [docker-compose.yml](docker-compose.yml) file is specified so as to enable configuring the failure probability of 13 out of the 14 running services.
Those services correspond to the services whose failure can cause a (cascading) failure in `edgeRouter`, which is the service acting as frontend of the application.

## The Experiment
The experiment is programmed within the [run.sh](run.sh) script, which (after creating a folder where to store the experiments' outcomes) works as follows.

For each service `s` among the 13 services whose failure can result in a (cascading) frontend failure: 
1. it generates a Docker Compose file such that the probability of `s` to fail is 50%, whilst those of the other services is set to 0%;
2. it deploys the resulting application, and loads it with the [generate_workload.sh](https://github.com/di-unipi-socc/chaos-echo/blob/main/generate_workload.sh) available in Chaos Echo's [repository](https://github.com/di-unipi-socc/chaos-echo);
3. it runs the deployment by ensuring that some failures occur/propagate up to the application frontend;
4. it stores the logs generated by the loaded deployment (in a file called `<s>-all.log`), by also eliciting the latest logged error event by the application frontend (in a file called `<s>-edgeRouter-fault.log`) and by the failing service `s` (in a file called `<s>-<s>-fault.log`)
5. it processes the logs with [explain.py](../../../explain.py) to explain the failure occurring in the frontend and in the service `s` (storing the outcomes respectively in files `<s>-edgeRouter-fault.output` and `<s>-<s>-fault.output`)

Note: all the logs and outputs produced by the experiment are placed in a `results_<dateTime>` folder (where `dateTime` is the date and time of launching the experiment)

## Running the Experiment
To run the experiment, issue the command
```
sudo nohup ./run.sh > runLog &
```
This will start the [run.sh](run.sh) script in background, storing its outputs in the file `runLog`, which can be read to observe what happened while the experiment was running (as well as to get the name of the folder where the experiments' outputs are stored).

(Note: `sudo` privileges are needed to enable restarting the Docker daemon between subsequent runs)